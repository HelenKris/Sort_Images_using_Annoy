
## Introduction

Если у вас много данных, полученных посредством парсинга различных интернет-ресурсов или вам необходимо собрать свой датасет под определенную задачу из уже собранного датасета, но явно избыточного или зашумленного для вашей задачи. Или у вас стоит задача как-то систематизировать собранный датасет для дальнейшей разметки, чтобы, например, удалить из него дубликаты либо очень схожие изображения, которые не внесут в обучение модели значимый вклад, то данный скрипт поможет вам в вашей работе с анализом и систематизацией вашего датасета.

## How to start?
1. Все изображения для анализа и систематизации должны находится в папке "all"
2. Вы можете сначала запустить скрипт search_image.py, чтобы получить все Annoy indexes
3. Затем запустить find_similar_images.py, чтобы получить для каждой фотографии свой кластер из похожих изображений из 24 штук (+исходное), это количество можно изменить в скрипте в строке nns = annoy_index.get_nns_by_vector(output_tensor[0], 24 ). Просмотреть, какие кластеры вас интересуют и на какие вы бы хотели расформировать свой датсет.
4. Перенести фотографии выбранных кластеров в папку find_similarities (по одной - первой, например, фотографии из кластера) и запустить скрипт find_and_move.py, в результате которого в корневой папке должны появиться папки с рассортированными кластерами фотографий (folder_1, folder_2....примеры, полученные по результату сортировки 4 фотографий)

## Пример собранных в датасете похожих изображений в одной подгруппе в ImageDump
![image_0](https://github.com/HelenKris/Sort_Images_using_Annoy/assets/128362457/bd038bfa-1fda-4fdf-ae65-6475befb1fd2)

## Project Structure
```
Sort_Images_using_Annoy/
├── search_image.py --формирует Annoy index для каждого изображения в папке all и сохраняет все индексы в файле paintings_index.ann, используя предварительно обученную модель в PyTorch и Spotify Annoy
├── find_similar_images.py  --формирует по каждому изображению image_grid из 25 похожих изображений (можно менять количество) для целей эксплоративного визуального анализа датасета
├── find_and_move.py  --производит поиск по сходству изображений и разносит группы схожих фотографий по разным папкам
├── all  -- папка со всеми изображениями датасета (для примера)
├── find_similarities  --папака с изображениями, для которых необходимо найти похожие и разделить по отдельным папкам (для примера)
└── paintings_index.ann - рассчитанные и сохраненные Annoy indexes изображений из папки 'all' (для примера)
